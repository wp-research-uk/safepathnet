<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Safe Real-World Autonomous Driving by Learning to Predict and Plan with a Mixture of Experts</title> <meta name="author" content="Woven Planet Holdings "/> <meta name="description" content="SafePathNet is a unified neural model for prediction and planning. The model learns a distribution over future trajectories that is leveraged to improve the safety of the planner by penalizing SDV plans that could lead to collisions with other road agents. "/> <meta name="keywords" content="autonomous-driving, self-driving, planning, prediction, safepathnet, woven-planet"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"/> <link rel="shortcut icon" href="/safepathnet/assets/img/wp_icon.ico"/> <link rel="stylesheet" href="/safepathnet/assets/css/main.css"> <link rel="canonical" href="https://wp-research-uk.github.io/safepathnet/"> </head> <body class=" sticky-bottom-footer"> <div class="container mt-5"> <div class="post"> <header class="post-header pb-3"> <h1 class="post-title text-center mb-3"> Safe Real-World Autonomous Driving by Learning to Predict and Plan with a Mixture of Experts </h1> <div class="container text-center text-big mt-2 mb-2"><div class="row"> <div class="col-6 col-md-4">Stefano Pini<sup>1</sup> </div> <div class="col-6 col-md-4">Christian S. Perone<sup>1</sup> </div> <div class="col-6 col-md-4">Aayush Ahuja<sup>2</sup> </div> <div class="col-6 col-md-4">Ana Sofia Rufino Ferreira<sup>2</sup> </div> <div class="col-6 col-md-4">Moritz Niendorf<sup>2</sup> </div> <div class="col-6 col-md-4">Sergey Zagoruyko<sup>1</sup> </div> </div></div> <div class="container text-center mt-2 mb-2"><div class="row"> <div class="col-12"> <sup>1</sup>Woven Planet United Kingdom Limited</div> <div class="col-12"> <sup>2</sup>Woven Planet North America, Inc</div> </div></div> <div class="container text-center font-italic mt-3 mb-3"><div class="row"> <div class="col-12">NeurIPS 2022 workshop on Machine Learning for Autonomous Driving (ML4AD)</div> </div></div> <div class="container text-center text-big mt-3 mb-3"><div class="row"><div class="col-12"> <a class="mx-2" href="https://arxiv.org/abs/2211.02131" target="_blank" rel="noopener noreferrer">Paper</a> <a class="mx-2" href="https://github.com/woven-planet/l5kit/tree/stefanopini/safepathnet" target="_blank" rel="noopener noreferrer">Code</a> <a class="mx-2" href="https://youtu.be/rLQXKcO20ck" target="_blank" rel="noopener noreferrer">Video</a> </div></div></div> </header> <article><figure> <picture> <img src="/safepathnet/assets/img/method.svg" class="figure-img img-fluid rounded" width="auto" height="auto" alt="High-level overview of SafePathNet, a ML approach improving on-road safety of self-driving vehicles (SDVs)." onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture><figcaption class="caption">High-level overview of SafePathNet, a ML approach improving on-road safety of self-driving vehicles (SDVs).</figcaption> </figure> <div class="clearfix mt-3 mb-3"> <h2 id="abstract">Abstract</h2> <p class="text-justify"> The goal of autonomous vehicles is to navigate public roads safely and comfortably. To enforce safety, traditional planning approaches rely on handcrafted rules to generate trajectories. Machine learning-based systems, on the other hand, scale with data and are able to learn more complex behaviors. However, they often ignore that agents and self-driving vehicle trajectory distributions can be leveraged to improve safety. In this paper, we propose modeling a distribution over multiple future trajectories for both the self-driving vehicle and other road agents, using a unified neural network architecture for prediction and planning. During inference, we select the planning trajectory that minimizes a cost taking into account safety and the predicted probabilities. Our approach does not depend on any rule-based planners for trajectory generation or optimization, improves with more training data and is simple to implement. We extensively evaluate our method through a realistic simulator and show that the predicted trajectory distribution corresponds to different driving profiles. We also successfully deploy it on a self-driving vehicle on urban public roads, confirming that it drives safely without compromising comfort. The code for training and testing our model on a public prediction dataset and the video of the road test are available at <a href="#">https://woven.mobi/safepathnet</a>. </p> <h2 id="road-test">Road test</h2> <p>We evaluated our approach through a realistic simulator and tested it on a real SDV in both our private testing facility and on public roads. Results show that SafePathNet presents a better trade-off between comfort (discomfort braking, passiveness) and safety (collisions) and brings us another step closer to our goal of safe real-world autonomous driving.</p> <div class="video-container mb-3"> <iframe src="https://www.youtube-nocookie.com/embed/rLQXKcO20ck" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe> </div> <h2 id="citation">Citation</h2> <p>If you find our paper or code useful, please cite our work as:</p> <pre><code>@article{pini2022safe,
  title={Safe Real-World Autonomous Driving by Learning to Predict and Plan with a Mixture of Experts},
  author={Pini, Stefano and Perone, Christian S and Ahuja, Aayush and Ferreira, Ana Sofia Rufino and Niendorf, Moritz and Zagoruyko, Sergey},
  journal={arXiv preprint arXiv:2211.02131},
  year={2022}
}</code>
</pre> </div> </article> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container"> Â© Copyright 2022 Woven Planet Holdings . Based on <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Last updated: December 03, 2022. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="/safepathnet/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>